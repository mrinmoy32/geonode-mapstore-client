(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[6879],{61018:(e,t,r)=>{"use strict";r.d(t,{Z:()=>y});var n=r(124852),o=r.n(n),i=r(807472),a=r(480681);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}var c=["show","style","modal","draggable","closeGlyph","closable","onClose","title","header","footer","children"];function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s.apply(null,arguments)}function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function f(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=l(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==l(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const y=function(e){var t=e.show,r=e.style,n=void 0===r?{}:r,l=e.modal,u=e.draggable,f=void 0!==u&&u,y=e.closeGlyph,m=void 0===y?"1-close":y,d=e.closable,b=void 0===d||d,h=e.onClose,v=void 0===h?function(){}:h,g=e.title,S=e.header,O=e.footer,w=e.children,E=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,c);return t?o().createElement(i.Z,s({modal:l,onClickOut:b&&l?function(){return v()}:null,style:p(p({},n),{},{display:t?"block":"none"}),draggable:f},E),o().createElement("span",{role:"header"},g||S||o().createElement("span",null,"Â "),b?o().createElement("button",{onClick:function(){return v()},className:"settings-panel-close close"},o().createElement(a.gG,{glyph:m})):null),o().createElement("span",{role:"body"},w),O?o().createElement("span",{role:"footer"},O):null):null}},857037:(e,t,r)=>{"use strict";r.d(t,{Z:()=>m});var n=r(124852),o=r.n(n),i=r(45697),a=r.n(i),l=r(24198),c=r(717621),s=r.n(c),u=r(290702);function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},p.apply(null,arguments)}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function y(e){var t,r,i=e.value,a=e.format,c=e.onChangeColor,y=e.text,m=e.line,d=e.disabled,b=e.pickerProps,h=e.containerNode,v=e.onOpen,g=e.placement,S=(t=(0,n.useState)(),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,l=[],c=!0,s=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return l}}(t,r)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),O=S[0],w=S[1],E=s()(i).toString();(0,n.useEffect)((function(){var e=O&&s()(O).toString();e&&E&&E!==e&&w(i)}),[E]);var P=(0,n.useRef)();P.current=function(e){v(e),e||d||!O||c(a?s()(O).toString(a):O)};var j,x,k=d?" ms-disabled":"";return o().createElement(u.Z,{disabled:d,onOpen:function(e){return P.current(e)},placement:g,containerNode:h,content:o().createElement(l.xS,p({},b,{className:"ms-sketch-picker",styles:{picker:{width:200,padding:"10px 10px 0",boxSizing:"initial"}},color:s()(O||i).toRgb(),onChange:function(e){return w(e.rgb)}}))},o().createElement("div",{className:"ms-color-picker".concat(k)},o().createElement("div",{className:"ms-color-picker-swatch",style:(j=O||i||"transparent",x=s()(j).toRgbString(),m?{boxSizing:"border-box",border:"4px solid ".concat(x),backgroundColor:"transparent"}:{color:"transparent"===j?"#000000":s().mostReadable(x,["#000000"],{includeFallbackColors:!0}).toHexString(),backgroundColor:x})},y)))}y.propTypes={value:a().oneOfType([a().string,a().shape({r:a().number,g:a().number,b:a().number,a:a().number})]),format:a().string,onChangeColor:a().func,text:a().string,line:a().bool,disabled:a().bool,pickerProps:a().object,containerNode:a().oneOfType([a().node,a().func]),onOpen:a().function,placement:a().string},y.defaultProps={disabled:!1,line:!1,onChangeColor:function(){},pickerProps:{},onOpen:function(){}};const m=y},290702:(e,t,r)=>{"use strict";r.d(t,{z:()=>g,Z:()=>S});var n=r(124852),o=r.n(n),i=r(180307),a=r(974691),l=r.n(a),c=r(737275),s=r(623560),u=r.n(s);function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}var f=["open","onOpen"];function y(){return y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},y.apply(null,arguments)}function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){b(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function b(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=p(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==p(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,l=[],c=!0,s=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return v(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?v(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function g(e){var t=e.containerNode,r=void 0===t?function(){return document.querySelector("."+((0,c.u8)("themePrefix")||"ms2")+" > div")||document.body}:t,a=e.placement,s=e.content,p=e.children,f=e.open,y=e.onOpen,m=void 0===y?function(){}:y,b=e.onClick,v=void 0===b?function(){}:b,g=e.disabled,S=e.triggerScrollableElement,O=10,w=u()(r)?r():r,E=(0,n.useRef)({picker:{opacity:0},arrow:{opacity:0},overlay:{}}),P=h((0,n.useState)(E.current),2),j=P[0],x=P[1],k=(0,n.useRef)(),T=(0,n.useRef)(),C=(0,n.useRef)(),M=(0,n.useCallback)((function(){var e,t,r,n,o,i;if(!f)return E.current;var c={picker:{},overlay:{backgroundColor:"rgba(0, 0, 0, 0.4)"},arrow:{opacity:0}};if("center"===a)return c;var s=null==k||null===(e=k.current)||void 0===e||null===(t=e.getBoundingClientRect)||void 0===t?void 0:t.call(e),u=null==T||null===(r=T.current)||void 0===r||null===(n=r.getBoundingClientRect)||void 0===n?void 0:n.call(r),p=null==C||null===(o=C.current)||void 0===o||null===(i=o.getBoundingClientRect)||void 0===i?void 0:i.call(o);if(s&&u&&p){var y,m,d,b,h=p.width,v=p.height,g=u.top,S=u.left,w=u.width,P=u.height,j=s.top,x=s.left,M=s.width,I=s.height,L=h+20<w,_=v+20<P,A={top:{filter:function(){return L&&j-g>v+O},styles:function(){var e=x+M/2-h/2-S;return{picker:{position:"absolute",top:j-v-O-g,left:l()(e,S+O,S+w-h-O)},overlay:{},arrow:{top:j+2,left:x+M/2,transform:"translate(-50%, -50%) rotateZ(270deg) translateX(50%)"}}}},right:{filter:function(){return _&&S+w-(x+M)>h+O},styles:function(){var e=j-v/2-g+I/2,t=x+M+O-S;return{picker:{position:"absolute",top:l()(e,g+O,g+P-v-O),left:t},overlay:{},arrow:{top:j+I/2,left:x+M-2,transform:"translate(-50%, -50%) rotateZ(0deg) translateX(50%)"}}}},bottom:{filter:function(){return L&&g+P-(j+I)>v+O},styles:function(){var e=x+M/2-h/2-S;return{picker:{position:"absolute",top:j+I+O-g,left:l()(e,S+O,S+w-h-O)},overlay:{},arrow:{top:j+I-2,left:x+M/2,transform:"translate(-50%, -50%) rotateZ(90deg) translateX(50%)"}}}},left:{filter:function(){return _&&x-S>h+O},styles:function(){var e=j-v/2-g+I/2,t=x-h-O-S;return{picker:{position:"absolute",top:l()(e,g+O,g+P-v-O),left:t},overlay:{},arrow:{top:j+I/2,left:x+2,transform:"translate(-50%, -50%) rotateZ(180deg) translateX(50%)"}}}}};if(null!=A&&null!==(y=A[a])&&void 0!==y&&null!==(m=y.filter)&&void 0!==m&&m.call(y))return null==A||null===(d=A[a])||void 0===d||null===(b=d.styles)||void 0===b?void 0:b.call(d);if("top"!==a&&A.top.filter())return A.top.styles();if("right"!==a&&A.right.filter())return A.right.styles();if("bottom"!==a&&A.bottom.filter())return A.bottom.styles();if("left"!==a&&A.left.filter())return A.left.styles()}return c}),[a,f]);(0,n.useEffect)((function(){x(M());var e=function(){return x(M())};return window.addEventListener("resize",e),S&&f&&S.addEventListener("scroll",e),function(){window.removeEventListener("resize",e),S&&S.removeEventListener("scroll",e)}}),[M]);var I=(0,n.useRef)();return I.current={open:f},(0,n.useEffect)((function(){function e(e){var t=C.current,r=k.current,n=e.target&&(t&&t.contains(e.target)||r&&r.contains(e.target));if(I.current.open&&!n){var o,i,a=e.clientX,l=e.clientY,c=(null==C||null===(o=C.current)||void 0===o||null===(i=o.getBoundingClientRect)||void 0===i?void 0:i.call(o))||{},s=c.left,u=c.top,p=c.width,f=c.height;void 0!==a&&void 0!==l&&!(a>=s&&a<=s+p&&l>=u&&l<=u+f)&&m(!1)}}return window.addEventListener("click",e,!0),window.addEventListener("wheel",e,!0),window.addEventListener("scroll",e,!0),function(){window.removeEventListener("click",e,!0),window.removeEventListener("wheel",e,!0),window.removeEventListener("scroll",e,!0)}}),[]),o().createElement(o().Fragment,null,o().createElement("div",{className:"ms-popover",ref:k},(0,n.cloneElement)(p,{onClick:function(e){g||(e.stopPropagation(),m(!f),v())}})),w&&f?(0,i.createPortal)(o().createElement("div",{className:"ms-popover-overlay",ref:T,style:d({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",top:0,left:0,pointerEvents:"none"},null==j?void 0:j.overlay)},o().createElement("div",{style:{position:"absolute",width:"100%",height:"100%",top:0,left:0}}),o().createElement("div",{ref:C,style:d({pointerEvents:"auto"},null==j?void 0:j.picker)},s),o().createElement("div",{className:"ms-popover-arrow",style:d({position:"absolute",borderTop:"".concat(12,"px solid transparent"),borderBottom:"".concat(12,"px solid transparent"),borderRight:"".concat(12,"px solid #ffffff"),filter:"drop-shadow(-4px 2px 4px rgba(0, 0, 0, 0.2))"},null==j?void 0:j.arrow)})),w):null)}const S=function(e){var t=e.open,r=e.onOpen,i=void 0===r?function(){}:r,a=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,f),l=h((0,n.useState)(t),2),c=l[0],s=l[1];return o().createElement(g,y({},a,{open:c,onOpen:function(e){s(e),i(e)}}))}},792350:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>cr});var n=r(867076),o=r(22222),i=r(124852),a=r.n(i),l=r(361123),c=r(867783),s=r(480681),u=r(38560),p=r(805346),f=r(615402);const y=function(e){var t=e.openFileDialog;return a().createElement("div",null,a().createElement(f.Z,{msgId:"mapImport.dropZone.heading"}),t?a().createElement(u.Z,{bsStyle:"primary",onClick:t},a().createElement(p.Z,{msgId:"mapImport.dropZone.selectFiles"})):null,a().createElement("br",null),a().createElement("br",null),a().createElement(f.Z,{msgId:"mapImport.dropZone.infoSupported"}),a().createElement("hr",null),a().createElement(f.Z,{msgId:"mapImport.dropZone.note"}))};var m=["error"],d={FILE_NOT_SUPPORTED:a().createElement(p.Z,{msgId:"mapImport.errors.fileNotSupported"}),PROJECTION_NOT_SUPPORTED:a().createElement(p.Z,{msgId:"mapImport.errors.projectionNotSupported"})};const b=(0,n.compose)((0,n.branch)((function(e){return e.loading}),(0,n.renderComponent)(c.Z)),(0,n.branch)((function(e){return e.error}),(0,n.renderComponent)((function(e){var t=e.error,r=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,m);return a().createElement("div",{style:{margin:"auto",maxWidth:550}},a().createElement("div",null,a().createElement(s.gG,{glyph:"exclamation-mark",style:{fontSize:80}})),a().createElement("h5",null,function(e){return e?d[e.message]||d[e]||a().createElement("span",null,a().createElement(p.Z,{msgId:"mapImport.errors.unknownError"}),":",a().createElement(s.bZ,{bsStyle:"warning"},e.message)):a().createElement(p.Z,{msgId:"mapImport.errors.unknownError"})}(t)),a().createElement(y,r))}))))((function(e){return a().createElement("div",null,a().createElement("div",null,a().createElement(s.gG,{glyph:"upload",style:{fontSize:80}})),a().createElement(y,e))}));var h=r(966085),v=r.n(h),g=r(500711),S=r.n(g),O=r(227361),w=r.n(O),E=r(359704),P=r.n(E),j=r(49977),x=r.n(j),k=r(900012),T=r(737275),C=r(988753),M=r(624262);function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function z(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=I(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=I(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==I(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var D=function(e){return new Promise((function(t,r){var n=(0,C.jU)(e.name),o=e.type||C.Yf[n];"application/x-zip-compressed"===o||"application/zip"===o||"application/vnd.google-earth.kml+xml"===o||"application/vnd.google-earth.kmz"===o||"application/gpx+xml"===o||"application/json"===o||"application/vnd.wmc"===o?t(e):function(e){return(0,C.xp)(e).then((function(e){return(new(v())).loadAsync(e)}))}(e).then((function(){return t(e)})).catch((function(){return r(new Error("FILE_NOT_SUPPORTED"))}))}))};const N=(0,n.compose)((0,n.mapPropsStream)((function(e){var t=(0,n.createEventHandler)(),r=t.handler,o=t.stream,i=(0,n.createEventHandler)(),a=i.handler,l=i.stream;return e.combineLatest(o.switchMap((function(e){return x().Observable.from(e).flatMap(D).flatMap(function(e){return function(t){var r=(0,C.jU)(t.name),n=t.type||C.Yf[r],o=T.ZP.getConfigProp("projectionDefs")||[],i=(o.length&&o.map((function(e){return e.code}))||[]).concat(["EPSG:4326","EPSG:3857","EPSG:900913"]);return"application/vnd.google-earth.kml+xml"===n?(0,C.BP)(t).then((function(e){return(0,C.bf)(e)})):"application/gpx+xml"===n?(0,C.BP)(t).then((function(e){return(0,C.cX)(e,t.name)})):"application/vnd.google-earth.kmz"===n?(0,C.N)(t).then((function(e){return(0,C.bf)(e)})):"application/x-zip-compressed"===n||"application/zip"===n?(0,C.xp)(t).then((function(r){return(0,C.Lz)(r).then((function(n){n.length>0&&e({type:"warning",filename:t.name,message:"shapefile.error.missingPrj"});var o=(0,C.mr)(r).map((function(e){return A(A({},e),{},{filename:t.name})}));if(P()(o,(function(e){return!!w()(e,"map.projection")}))){var a=o.filter((function(e){return!!w()(e,"map.projection")}));if(S()(a,(function(e){return i.includes(e.map.projection)})))return o;throw new Error("PROJECTION_NOT_SUPPORTED")}return o}))})):"application/json"===n?(0,C.zr)(t).then((function(e){var r=w()(e,"map.projection");if(r){if(i.includes(r))return[A(A({},e),{},{fileName:t.name})];throw new Error("PROJECTION_NOT_SUPPORTED")}return[A(A({},e),{},{fileName:t.name})]})):"application/vnd.wmc"===n?(0,C.IN)(t).then((function(e){return[A(A({},e),{},{fileName:t.name})]})):null}}(a)).reduce((function(e,t){return{layers:(e.layers||[]).concat(t.filter((function(e){return function(e){return e&&e.features&&0!==e.features.length}(e)})).map((function(e){return(0,k.Ag)(e)?{name:"Annotations",features:(0,k.Z7)(e),filename:e.filename}:A(A({},(0,M.Rt)(e)),{},{filename:e.filename})}))),maps:(e.maps||[]).concat(t.filter((function(e){return function(e){return e&&e.version&&e.map}(e)})))}}),{}).map((function(e){return{loading:!1,files:e}})).catch((function(e){return x().Observable.of({error:e,loading:!1})})).startWith({loading:!0})})).startWith({}),(function(e,t){return A(A(A({},e),t),{},{onDrop:r})})).combineLatest(l.scan((function(){var e,t=arguments.length>1?arguments[1]:void 0;return[].concat(function(e){if(Array.isArray(e))return L(e)}(e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[])||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return L(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[t])}),[]).startWith(void 0),(function(e,t){return A(A({},e),{},{warnings:t})}))})));var R=r(916651);function X(e){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(e)}function Z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(r),!0).forEach((function(t){J(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function J(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=X(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=X(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==X(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const F=(0,n.compose)((0,n.withHandlers)({useFiles:function(e){var t=e.currentMap,r=e.loadMap,n=void 0===r?function(){}:r,o=e.loadMapInfo,i=void 0===o?function(){}:o,a=e.onClose,l=void 0===a?function(){}:a,c=e.setLayers,s=void 0===c?function(){}:c,u=e.annotationsLayer,p=e.loadAnnotations,f=void 0===p?function(){}:p,y=e.warning,m=void 0===y?function(){}:y;return function(e,r){var o=e.layers,a=void 0===o?[]:o,c=e.maps,p=(void 0===c?[]:c)[0];if(p){var y=t.zoom,d=t.center,b=t.mapId,h=p.fileName;n(B(B({},p),{},{map:B(B({},p.map),{},{zoom:p.map.zoom||y,center:p.map.center||d})}),b||null,!p.map.zoom&&(p.map.bbox||{bounds:p.map.maxExtent})),b&&h&&i(b),l()}if(a.length>0){var v=a&&"Annotations"===a[0].name;if(!u&&v)f(a[0].features,!1),l();else{var g=[];a.forEach((function(e){var t;"vector"!==e.type||(0,R.checkIfLayerFitsExtentForProjection)(e)?g.push(e):m({title:"notification.warning",message:"mapImport.errors.fileBeyondBoundaries",autoDismiss:6,position:"tc",values:{filename:null!==(t=e.name)&&void 0!==t?t:" "}})})),s(g,r)}}}}}),(0,n.mapPropsStream)((function(e){return e.merge(e.distinctUntilKeyChanged("files").filter((function(e){return e.files})).do((function(e){var t=e.files,r=e.useFiles,n=void 0===r?function(){}:r,o=e.warnings;return n(t,void 0===o?[]:o)})).ignoreElements())})));var G=r(565178),U=["onClose","onDrop","onRef"];const W=(0,n.compose)(N,F,G.Z)((function(e){var t=e.onClose,r=void 0===t?function(){}:t,n=e.onDrop,o=void 0===n?function(){}:n,i=e.onRef,c=void 0===i?function(){}:i,s=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,U);return a().createElement(l.Z,{onClose:r,onDrop:o,onRef:c},a().createElement(b,s))}));var $=r(171703),q=r(45697),H=r.n(q),Y=r(481756),K=r(12440),Q=r(442416),V=r(747037),ee=r.n(V),te=r(200020),re=r(86638),ne=r(855033),oe=r.n(ne),ie=r(472986),ae=r.n(ie),le=r(882702);function ce(e){return ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ce(e)}function se(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,de(n.key),n)}}function ue(e,t,r){return t=fe(t),function(e,t){if(t&&("object"==ce(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,pe()?Reflect.construct(t,r||[],fe(e).constructor):t.apply(e,r))}function pe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(pe=function(){return!!e})()}function fe(e){return fe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},fe(e)}function ye(e,t){return ye=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ye(e,t)}function me(e,t,r){return(t=de(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function de(e){var t=function(e,t){if("object"!=ce(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=ce(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ce(t)?t:t+""}var be=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return me(e=ue(this,t,[].concat(n)),"tryUnzip",(function(e){return(0,C.xp)(e).then((function(e){return(new(v())).loadAsync(e)}))})),me(e,"checkFileType",(function(t){return new le.Promise((function(r,n){var o=(0,C.jU)(t.name),i=t.type||C.Yf[o];"application/x-zip-compressed"===i||"application/zip"===i||"application/vnd.google-earth.kml+xml"===i||"application/vnd.google-earth.kmz"===i||"application/gpx+xml"===i?r():e.tryUnzip(t).then(r).catch(n)}))})),me(e,"checkfile",(function(t){le.Promise.all(t.map((function(t){return e.checkFileType(t)}))).then((function(){e.props.error&&e.props.onShapeError(null),e.props.onShapeChoosen(t)})).catch((function(){var t=(0,re.S$)(e.context.messages,e.props.errorMessage);e.props.onShapeError(t)}))})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ye(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){return this.props.loading?a().createElement("div",{className:"btn btn-info",style:{float:"center"}}," ",a().createElement(ae(),{spinnerName:"circle",noFadeIn:!0,overrideSpinnerClassName:"spinner"})):a().createElement(oe(),{rejectClassName:"alert-danger",className:"alert alert-info",onDrop:this.checkfile},a().createElement("div",{className:"dropzone-content",style:{textAlign:"center"}},this.props.text))}}])&&se(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(a().Component);me(be,"propTypes",{text:H().oneOfType([H().string,H().element]),loading:H().bool,onShapeChoosen:H().func,onShapeError:H().func,error:H().oneOfType([H().string,H().element]),errorMessage:H().string}),me(be,"contextTypes",{messages:H().object}),me(be,"defaultProps",{text:"Drop or click to import a local Shape",onShapeChoosen:function(){},onShapeError:function(){},errorMessage:"shapefile.error.select"});const he=be;function ve(e){return ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ve(e)}function ge(){return ge=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ge.apply(null,arguments)}function Se(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xe(n.key),n)}}function Oe(e,t,r){return t=Ee(t),function(e,t){if(t&&("object"==ve(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,we()?Reflect.construct(t,r||[],Ee(e).constructor):t.apply(e,r))}function we(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(we=function(){return!!e})()}function Ee(e){return Ee=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ee(e)}function Pe(e,t){return Pe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Pe(e,t)}function je(e,t,r){return(t=xe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xe(e){var t=function(e,t){if("object"!=ve(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=ve(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ve(t)?t:t+""}var ke=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return je(e=Oe(this,t,[].concat(n)),"state",{useDefaultStyle:!1,zoomOnShapefiles:!0}),je(e,"getGeometryType",(function(e){if(e&&"GeometryCollection"===e.type)return e.geometries.reduce((function(e,t){return t&&t.type===e?e:t.type}),null);if(e)switch(e.type){case"Polygon":case"MultiPolygon":return"Polygon";case"MultiLineString":case"LineString":return"LineString";case"Point":case"MultiPoint":return"Point";default:return null}return null})),je(e,"getGeomType",(function(t){return t&&t.features&&t.features[0].geometry?t.features.reduce((function(t,r){var n=e.getGeometryType(r.geometry);return t?n===t?t:"GeometryCollection":n}),null):null})),je(e,"renderError",(function(){return a().createElement(s.X2,null,a().createElement("div",{style:{textAlign:"center"},className:"alert alert-danger"},a().createElement(p.Z,{msgId:e.props.error})))})),je(e,"renderSuccess",(function(){return a().createElement(s.X2,null,a().createElement("div",{style:{textAlign:"center",overflowWrap:"break-word"},className:"alert alert-success"},e.props.success))})),je(e,"renderStyle",(function(){return e.props.stylers[e.getGeomType(e.props.selected)]})),je(e,"renderDefaultStyle",(function(){return e.props.selected?a().createElement(s.X2,null,a().createElement(s.JX,{xs:2},a().createElement("input",{"aria-label":"...",type:"checkbox",defaultChecked:e.state.useDefaultStyle,onChange:function(t){e.setState({useDefaultStyle:t.target.checked})}})),a().createElement(s.JX,{style:{paddingLeft:0,paddingTop:1},xs:10},a().createElement("label",null,a().createElement(p.Z,{msgId:"shapefile.defaultStyle"}))),a().createElement(s.JX,{xs:2},a().createElement("input",{"aria-label":"...",type:"checkbox",defaultChecked:e.state.zoomOnShapefiles,onChange:function(t){e.setState({zoomOnShapefiles:t.target.checked})}})),a().createElement(s.JX,{style:{paddingLeft:0,paddingTop:1},xs:10},a().createElement("label",null,a().createElement(p.Z,{msgId:"shapefile.zoom"})))):null})),je(e,"addShape",(function(t){e.props.shapeLoading(!0);var r=e.props.readFiles(t,e.props.onShapeError);le.Promise.all(r).then((function(t){var r=t.filter((function(e){return e[0]&&e[0].features&&0!==e[0].features.length||"Feature"===e[0].type}));r=r.reduce((function(t,r){return r?t.concat(r.map((function(t){return(0,M.Rt)(t,e.props.createId(t,r))}))):t}),[]),e.props.onShapeChoosen(r),e.props.shapeLoading(!1)})).catch((function(t){e.props.shapeLoading(!1);var r=t&&t.name||t||"";ee()(r)&&"SyntaxError"===r?e.props.onShapeError("shapefile.error.shapeFileParsingError"):e.props.onShapeError("shapefile.error.genericLoadError")}))})),je(e,"addToMap",(function(){e.props.shapeLoading(!0);var t=e.props.selected;le.Promise.resolve(e.props.addShapeLayer(t)).then((function(){e.props.shapeLoading(!1);var t=[];e.props.layers[0].bbox&&e.props.bbox&&(t=[Math.min(e.props.bbox[0],e.props.layers[0].bbox.bounds.minx),Math.min(e.props.bbox[1],e.props.layers[0].bbox.bounds.miny),Math.max(e.props.bbox[2],e.props.layers[0].bbox.bounds.maxx),Math.max(e.props.bbox[3],e.props.layers[0].bbox.bounds.maxy)]),e.state.zoomOnShapefiles&&(e.props.updateShapeBBox(t&&t.length?t:e.props.bbox),e.props.onZoomSelected(t&&t.length?t:e.props.bbox,"EPSG:4326")),e.props.onShapeSuccess(e.props.layers[0].name+(0,re.S$)(e.context.messages,"shapefile.success")),e.props.onLayerAdded(e.props.selected)})).catch((function(){e.props.shapeLoading(!1),e.props.onShapeError("shapefile.error.genericLoadError")}))})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pe(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this;return a().createElement(s.rj,{role:"body",style:{width:"300px"},fluid:!0},this.props.error?this.renderError():null,this.props.success?this.renderSuccess():null,a().createElement(s.X2,{style:{textAlign:"center"}},this.props.selected?a().createElement(te.DropdownList,{data:this.props.layers,value:this.props.selected,onSelect:function(t){return e.props.onSelectLayer(t)},valueField:"id",textField:"name"}):a().createElement(he,ge({},this.props.uploadOptions,{errorMessage:"shapefile.error.select",text:this.props.uploadMessage,onShapeChoosen:this.addShape,onShapeError:this.props.onShapeError}))),a().createElement(s.X2,{style:{marginBottom:10}},this.state.useDefaultStyle?null:this.renderStyle()),this.renderDefaultStyle(),this.props.selected?a().createElement(s.X2,null,a().createElement(s.JX,{xsOffset:6,xs:3}," ",a().createElement(u.Z,{bsSize:this.props.buttonSize,disabled:!this.props.selected,onClick:function(){e.props.onShapeChoosen(null)}},this.props.cancelMessage)),a().createElement(s.JX,{xs:3}," ",a().createElement(u.Z,{bsStyle:"primary",bsSize:this.props.buttonSize,disabled:!this.props.selected,onClick:this.addToMap},this.props.addMessage))):null)}}])&&Se(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(a().Component);je(ke,"propTypes",{bbox:H().array,layers:H().array,selected:H().object,style:H().object,shapeStyle:H().object,readFiles:H().func,onShapeError:H().func,onShapeSuccess:H().func,onShapeChoosen:H().func,addShapeLayer:H().func,shapeLoading:H().func,onSelectLayer:H().func,onLayerAdded:H().func,onZoomSelected:H().func,updateShapeBBox:H().func,error:H().string,success:H().string,buttonSize:H().string,uploadMessage:H().object,cancelMessage:H().object,addMessage:H().object,stylers:H().object,uploadOptions:H().object,createId:H().func}),je(ke,"contextTypes",{messages:H().object}),je(ke,"defaultProps",{shapeLoading:function(){},readFiles:function(e,t){return e.map((function(e){var r=(0,C.jU)(e.name),n=e.type||C.Yf[r];return"application/vnd.google-earth.kml+xml"===n?(0,C.BP)(e).then((function(e){return(0,C.bf)(e)})):"application/gpx+xml"===n?(0,C.BP)(e).then((function(e){return(0,C.cX)(e)})):"application/vnd.google-earth.kmz"===n?(0,C.N)(e).then((function(e){return(0,C.bf)(e)})):"application/x-zip-compressed"===n||"application/zip"===n?(0,C.xp)(e).then((function(e){return(0,C.Lz)(e).then((function(r){return r.length>0&&t("shapefile.error.missingPrj"),(0,C.mr)(e)}))})):null}))},stylers:{},buttonSize:"small",uploadOptions:{},createId:function(){},bbox:null});const Te=ke;var Ce=r(857037),Me=r(903918),Ie=r.n(Me),Le=r(166287);function _e(e){return _e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_e(e)}function Ae(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ze(n.key),n)}}function ze(e,t,r){return t=Ne(t),function(e,t){if(t&&("object"==_e(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,De()?Reflect.construct(t,r||[],Ne(e).constructor):t.apply(e,r))}function De(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(De=function(){return!!e})()}function Ne(e){return Ne=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ne(e)}function Re(e,t){return Re=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Re(e,t)}function Xe(e,t,r){return(t=Ze(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ze(e){var t=function(e,t){if("object"!=_e(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=_e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==_e(t)?t:t+""}var Be=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return Xe(e=ze(this,t,[].concat(o)),"paint",(function(t){t.save(),t.beginPath();var r=e.props.shapeStyle,n=r.color,o=r.fill;switch(t.fillStyle=o?ee()(o)?o:"rgba(".concat(o.r,", ").concat(o.g,", ").concat(o.b,", ").concat(o.a,")"):null,t.strokeStyle=n?ee()(n)?n:"rgba(".concat(n.r,", ").concat(n.g,", ").concat(n.b,", ").concat(n.a,")"):null,t.lineWidth=e.props.shapeStyle.width||e.props.shapeStyle.weight,e.props.shapeStyle.dashArray&&e.props.shapeStyle.dashArray.length&&t.setLineDash(e.props.shapeStyle.dashArray),e.props.geomType){case"Polygon":e.paintPolygon(t);break;case"Polyline":e.paintPolyline(t);break;case"Point":e.paintPoint(t,e.props.shapeStyle.markName);break;case"Circle":e.paintPoint(t,"circle");break;case"Marker":e.paintMarker(t);break;case"Text":e.paintText(t);break;case"Symbol":e.paintSymbol(t);break;default:return}t.restore()})),Xe(e,"drawSymbol",(function(t,n){n.clearRect(0,0,600,600);var o=new Image,i=new Image;i.src=r(218845),o.src=t||e.props.shapeStyle.symbolUrl,o.onload=function(){try{n.drawImage(o,e.props.width/2-o.width/2,e.props.height/2-o.height/2)}catch(e){return}},o.onerror=function(){i.onload=function(){try{n.drawImage(i,e.props.width/2-i.width/2,e.props.height/2-i.height/2)}catch(e){return}}}})),Xe(e,"paintSymbol",(function(t){(0,Le.isSymbolStyle)(e.props.originalStyle)?e.props.originalStyle.symbolUrlCustomized&&e.props.originalStyle.symbolUrl?e.drawSymbol(e.props.originalStyle.symbolUrlCustomized,t):(0,Le.createSvgUrl)(e.props.originalStyle,e.props.originalStyle.symbolUrlCustomized||e.props.originalStyle.symbolUrl).then((function(r){return e.drawSymbol(r,t)})):e.drawSymbol(null,t)})),Xe(e,"paintText",(function(t){var r=e.props,n=r.width,o=r.height,i=e.props.shapeStyle,a=i.textAlign,l=void 0===a?"center":a,c=i.label,s=i.font,u=void 0===s?"14px Arial":s;return t.textAlign=l,t.font=u,"start"===l?(t.strokeText(c||"New",n/2.5,o/2),void t.fillText(c||"New",n/2.5,o/2)):"end"===l?(t.strokeText(c||"New",n/1.5,o/2),void t.fillText(c||"New",n/1.5,o/2)):(t.strokeText(c||"New",n/2,o/2),void t.fillText(c||"New",n/2,o/2))})),Xe(e,"paintPolygon",(function(e){e.transform(1,0,0,1,-27.5,0),e.moveTo(55,8),e.lineTo(100,8),e.lineTo(117.5,40),e.lineTo(100,72),e.lineTo(55,72),e.lineTo(37.5,40),e.closePath(),e.fill(),e.stroke()})),Xe(e,"paintPolyline",(function(e){e.transform(1,0,0,1,0,0),e.moveTo(10,20),e.bezierCurveTo(40,40,70,0,90,20),e.stroke()})),Xe(e,"paintPoint",(function(t,r){var n=e.props.shapeStyle.radius,o=n/2;switch(r){case"square":t.rect(50-o,48.5-o,n,n);break;case"circle":t.arc(50,48.5,o,0,2*Math.PI);break;case"triangle":var i=Math.sqrt(3)*n/2/3;t.moveTo(50,48.5-2*i),t.lineTo(50+o,48.5+i),t.lineTo(50-o,48.5+i),t.closePath();break;case"star":e.paintStar(t,50,48.5,5,o,o/2);break;case"cross":e.paintCross(t,50,48.5,n,.23);break;case"x":t.translate(50,48.5),t.rotate(45*Math.PI/180),t.translate(-50,-48.5),e.paintCross(t,50,48.5,n,.23);break;default:t.arc(50,48.5,n,0,2*Math.PI)}t.fill(),t.stroke()})),Xe(e,"paintMarker",(function(e){var t=new Image;t.src=Ie();try{e.drawImage(t,42.5,24)}catch(e){return}})),Xe(e,"paintStar",(function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,o=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,a=Math.PI/2*3,l=t,c=r,s=Math.PI/n;e.moveTo(t,r-o);for(var u=0;u<n;u++)l=t+Math.cos(a)*o,c=r+Math.sin(a)*o,e.lineTo(l,c),a+=s,l=t+Math.cos(a)*i,c=r+Math.sin(a)*i,e.lineTo(l,c),a+=s;e.lineTo(t,r-o),e.closePath()})),Xe(e,"paintCross",(function(e,t,r,n,o){var i=n*o/2,a=n/2;e.moveTo(t-i,r-a),e.lineTo(t+i,r-a),e.lineTo(t+i,r-i),e.lineTo(t+a,r-i),e.lineTo(t+a,r+i),e.lineTo(t+i,r+i),e.lineTo(t+i,r+a),e.lineTo(t-i,r+a),e.lineTo(t-i,r+i),e.lineTo(t-a,r+i),e.lineTo(t-a,r-i),e.lineTo(t-i,r-i),e.closePath()})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Re(e,t)}(t,e),n=t,(o=[{key:"componentDidMount",value:function(){var e=this.refs.styleCanvas.getContext("2d");e.clearRect(0,0,this.props.width||500,this.props.height||500),this.paint(e)}},{key:"componentDidUpdate",value:function(){var e=this.refs.styleCanvas.getContext("2d");e.clearRect(0,0,this.props.width||500,this.props.height||500),this.paint(e)}},{key:"render",value:function(){return a().createElement("canvas",{ref:"styleCanvas",style:this.props.style,width:this.props.width,height:this.props.height})}}])&&Ae(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,o}(a().Component);Xe(Be,"propTypes",{originalStyle:H().object,style:H().object,shapeStyle:H().object,geomType:H().oneOf(["Polygon","Polyline","Point","Marker","Text","Symbol","Circle",void 0]),width:H().number,height:H().number}),Xe(Be,"defaultProps",{originalStyle:{},style:{},shapeStyle:{},geomType:"Polygon",width:100,height:80});const Je=Be;function Fe(e){return Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fe(e)}function Ge(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ye(n.key),n)}}function Ue(e,t,r){return t=$e(t),function(e,t){if(t&&("object"==Fe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,We()?Reflect.construct(t,r||[],$e(e).constructor):t.apply(e,r))}function We(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(We=function(){return!!e})()}function $e(e){return $e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$e(e)}function qe(e,t){return qe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},qe(e,t)}function He(e,t,r){return(t=Ye(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ye(e){var t=function(e,t){if("object"!=Fe(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Fe(t)?t:t+""}var Ke=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ue(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qe(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this;return a().createElement(te.DropdownList,{data:[{value:"circle",name:(0,re.S$)(this.context.messages,"markNameSelector.circle")||"Circle"},{value:"square",name:(0,re.S$)(this.context.messages,"markNameSelector.square")||"Square"},{value:"triangle",name:(0,re.S$)(this.context.messages,"markNameSelector.triangle")||"Triangle"},{value:"star",name:(0,re.S$)(this.context.messages,"markNameSelector.star")||"Star"},{value:"cross",name:(0,re.S$)(this.context.messages,"markNameSelector.cross")||"Cross"},{value:"x",name:(0,re.S$)(this.context.messages,"markNameSelector.x")||"X"}],valueField:"value",textField:"name",value:this.props.markName,onChange:function(t){return e.props.onChange("markName",t.value)}})}}])&&Ge(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(a().Component);He(Ke,"propTypes",{markName:H().string,onChange:H().func}),He(Ke,"contextTypes",{messages:H().object}),He(Ke,"defaultProps",{markName:"circle",onChange:function(){}});const Qe=Ke;var Ve=r(509886),et=r.n(Ve);function tt(e){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tt(e)}function rt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ct(n.key),n)}}function nt(e,t,r){return t=it(t),function(e,t){if(t&&("object"==tt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ot()?Reflect.construct(t,r||[],it(e).constructor):t.apply(e,r))}function ot(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ot=function(){return!!e})()}function it(e){return it=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},it(e)}function at(e,t){return at=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},at(e,t)}function lt(e,t,r){return(t=ct(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ct(e){var t=function(e,t){if("object"!=tt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=tt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==tt(t)?t:t+""}et()();var st=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),nt(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&at(e,t)}(t,e),r=t,n=[{key:"render",value:function(){var e=this;return a().createElement(s.rj,{fluid:!0},a().createElement(s.X2,null,a().createElement(s.JX,{xs:4,style:{padding:0}},a().createElement(Je,{style:{padding:0,margin:"auto",display:"block"},height:97,shapeStyle:this.props.shapeStyle,geomType:this.props.shapeStyle.marker?"Marker":"Point"})),a().createElement(s.JX,{xs:7},this.props.showMarker?a().createElement(s.X2,null,a().createElement(s.JX,{xs:1},a().createElement("input",{"aria-label":"...",type:"checkbox",defaultChecked:this.props.shapeStyle.marker,onChange:function(t){e.props.setStyleParameter("marker",t.target.checked)}})),a().createElement(s.JX,{style:{paddingLeft:0,paddingTop:1},xs:4},a().createElement("label",null,"Marker"))):null,this.props.showMarkSelector?a().createElement(s.X2,{style:{marginBottom:4}},a().createElement(s.JX,{style:{paddingTop:7},xs:4},a().createElement("label",null,"Mark")),a().createElement(s.JX,{xs:8,style:{paddingRight:0,paddingLeft:30}},a().createElement(Qe,{onChange:this.props.setStyleParameter,markName:this.props.shapeStyle.markName}))):null,a().createElement(s.X2,null,a().createElement(s.JX,{xs:4},a().createElement(Ce.Z,{disabled:this.props.shapeStyle.marker,value:this.props.shapeStyle.color,line:!1,text:"Stroke",onChangeColor:function(t){t&&e.props.setStyleParameter("color",t)}})),a().createElement(s.JX,{xs:8,style:{paddingRight:0,paddingLeft:30}},a().createElement(te.NumberPicker,{disabled:this.props.shapeStyle.marker,min:1,max:15,step:1,value:this.props.shapeStyle.width,onChange:function(t){e.props.shapeStyle.width!==t&&e.props.setStyleParameter("width",t)}}))),a().createElement(s.X2,{style:{marginTop:4}},a().createElement(s.JX,{xs:4},a().createElement(Ce.Z,{disabled:this.props.shapeStyle.marker,value:this.props.shapeStyle.fill,line:!1,text:"Fill",onChangeColor:function(t){t&&e.props.setStyleParameter("fill",t)}})),a().createElement(s.JX,{xs:8,style:{paddingRight:0,paddingLeft:30}},a().createElement(te.NumberPicker,{disabled:this.props.shapeStyle.marker,min:1,max:50,step:1,value:this.props.shapeStyle.radius,onChange:function(t){e.props.shapeStyle.radius!==t&&e.props.setStyleParameter("radius",t)}}))))))}}],n&&rt(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(a().Component);lt(st,"propTypes",{shapeStyle:H().object,setStyleParameter:H().func,showMarker:H().bool,showMarkSelector:H().bool}),lt(st,"defaultProps",{shapeStyle:{},showMarker:!0,showMarkSelector:!1,setStyleParameter:function(){}});const ut=st;function pt(e){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pt(e)}function ft(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vt(n.key),n)}}function yt(e,t,r){return t=dt(t),function(e,t){if(t&&("object"==pt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,mt()?Reflect.construct(t,r||[],dt(e).constructor):t.apply(e,r))}function mt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(mt=function(){return!!e})()}function dt(e){return dt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dt(e)}function bt(e,t){return bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},bt(e,t)}function ht(e,t,r){return(t=vt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vt(e){var t=function(e,t){if("object"!=pt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=pt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==pt(t)?t:t+""}et()();var gt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),yt(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bt(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this;return a().createElement(s.rj,{fluid:!0},a().createElement(s.X2,null,a().createElement(s.JX,{xs:4,style:{padding:0}},a().createElement(Je,{style:{padding:0,margin:"auto",display:"block"},shapeStyle:this.props.shapeStyle,geomType:"Polygon"})),a().createElement(s.JX,{xs:7},a().createElement(s.X2,{style:{marginTop:7}},a().createElement(s.JX,{xs:4},a().createElement(Ce.Z,{value:this.props.shapeStyle.color,line:!1,text:"Stroke",onChangeColor:function(t){t&&e.props.setStyleParameter("color",t)}})),a().createElement(s.JX,{xs:8,style:{paddingRight:0,paddingLeft:30}},a().createElement(te.NumberPicker,{min:1,max:15,step:1,value:this.props.shapeStyle.width,onChange:function(t){t!==e.props.shapeStyle.width&&e.props.setStyleParameter("width",t)}}))),a().createElement(s.X2,{style:{marginTop:4}},a().createElement(s.JX,{xs:6},a().createElement(Ce.Z,{value:this.props.shapeStyle.fill,line:!1,text:"Fill",onChangeColor:function(t){t&&e.props.setStyleParameter("fill",t)}}))))))}}])&&ft(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(a().Component);ht(gt,"propTypes",{shapeStyle:H().object,setStyleParameter:H().func}),ht(gt,"defaultProps",{shapeStyle:{},setStyleParameter:function(){}});const St=gt;function Ot(e){return Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ot(e)}function wt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Tt(n.key),n)}}function Et(e,t,r){return t=jt(t),function(e,t){if(t&&("object"==Ot(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Pt()?Reflect.construct(t,r||[],jt(e).constructor):t.apply(e,r))}function Pt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Pt=function(){return!!e})()}function jt(e){return jt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},jt(e)}function xt(e,t){return xt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xt(e,t)}function kt(e,t,r){return(t=Tt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tt(e){var t=function(e,t){if("object"!=Ot(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=Ot(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ot(t)?t:t+""}et()();var Ct=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Et(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xt(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this;return a().createElement(s.rj,{fluid:!0},a().createElement(s.X2,null,a().createElement(s.JX,{xs:4,style:{padding:0}},a().createElement(Je,{style:{padding:0,margin:"auto",display:"block"},shapeStyle:this.props.shapeStyle,geomType:"Polyline",height:40})),a().createElement(s.JX,{xs:7},a().createElement(s.X2,{style:{marginTop:7}},a().createElement(s.JX,{xs:4},a().createElement(Ce.Z,{value:this.props.shapeStyle.color,line:!1,text:"Stroke",onChangeColor:function(t){t&&e.props.setStyleParameter("color",t)}})),a().createElement(s.JX,{xs:8,style:{paddingRight:0,paddingLeft:30}},a().createElement(te.NumberPicker,{onChange:function(t){e.props.setStyleParameter("width",t)},min:1,max:15,step:1,value:this.props.shapeStyle.width}))))))}}])&&wt(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(a().Component);kt(Ct,"propTypes",{shapeStyle:H().object,setStyleParameter:H().func}),kt(Ct,"defaultProps",{shapeStyle:{},setStyleParameter:function(){}});const Mt=Ct;(0,$.connect)((function(e){return{uploadOptions:{error:e.mapimport&&e.mapimport.error||null,loading:e.mapimport&&e.mapimport.loading||!1}}}),{onShapeError:K.bM})(Te);var It=(0,$.connect)((function(e){return{shapeStyle:e.style||{}}}),{setStyleParameter:Q.q})(St),Lt=(0,$.connect)((function(e){return{shapeStyle:e.style||{}}}),{setStyleParameter:Q.q})(ut),_t=(0,$.connect)((function(e){return{shapeStyle:e.style||{}}}),{setStyleParameter:Q.q})(Mt),At=r(904679),zt=function(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!(!["geostyler"].includes(null==r||null===(e=r.style)||void 0===e?void 0:e.format)||null==r||null===(t=r.style)||void 0===t||!t.body)||!(!r||!r.features.length)&&r.features.reduce((function(e,t){var r=t.style&&Array.isArray(t.style)&&t.style.length||Object.keys(t.style||{}).length;return e||!!r}),!1)};function Dt(e){return Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dt(e)}function Nt(e){return function(e){if(Array.isArray(e))return Rt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Rt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Rt(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Xt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ut(n.key),n)}}function Zt(e,t,r){return t=Jt(t),function(e,t){if(t&&("object"==Dt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Bt()?Reflect.construct(t,r||[],Jt(e).constructor):t.apply(e,r))}function Bt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Bt=function(){return!!e})()}function Jt(e){return Jt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Jt(e)}function Ft(e,t){return Ft=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ft(e,t)}function Gt(e,t,r){return(t=Ut(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ut(e){var t=function(e,t){if("object"!=Dt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=Dt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Dt(t)?t:t+""}var Wt=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Gt(e=Zt(this,t,[].concat(n)),"state",{useDefaultStyle:!1,zoomOnShapefiles:!0,overrideAnnotation:!1,initialLayers:[]}),Gt(e,"getGeometryType",(function(e){if(e&&"GeometryCollection"===e.type)return e.geometries.reduce((function(e,t){return t&&t.type===e?e:t.type}),null);if(e)switch(e.type){case"Polygon":case"MultiPolygon":return"Polygon";case"MultiLineString":case"LineString":return"LineString";case"Point":case"MultiPoint":return"Point";default:return null}return null})),Gt(e,"getGeomType",(function(t){return t&&t.features&&t.features[0].geometry?t.features.reduce((function(t,r){var n=e.getGeometryType(r.geometry);return t?n===t?t:"GeometryCollection":n}),null):null})),Gt(e,"renderError",(function(){return e.props.errors&&e.props.errors.filter((function(t){return(t.filename||t.name)&&e.props.layers&&e.props.layers[0]&&(e.props.layers[0].filename===t.filename||e.props.layers[0].name===t.name)})).map((function(e){return a().createElement(s.X2,{key:e&&e.name+e.message},a().createElement(s.bZ,{bsStyle:e.type,style:{textAlign:"center"}},a().createElement(p.Z,{msgId:e.message})))}))})),Gt(e,"renderSuccess",(function(){return a().createElement(s.X2,null,a().createElement("div",{style:{textAlign:"center",overflowWrap:"break-word"},className:"alert alert-success"},e.props.success))})),Gt(e,"renderDisableStyleCustomization",(function(e){return e?a().createElement("div",{className:"alert alert-info mb-2 style-customisation-disabled-container"},a().createElement(p.Z,{msgId:"shapefile.styleCustomizationDisabled"})):null})),Gt(e,"findLayerSerialNumber",(function(t){var r=t.name;return e.state.initialLayers.findIndex((function(e){return e.name===r}))+1})),Gt(e,"addToMap",(function(){var t=zt(e.props.selected),r=(0,k.Ag)(e.props.selected),n=r||e.state.useDefaultStyle||t?e.props.selected:(0,At.p)(e.props.selected,e.props.shapeStyle);le.Promise.resolve(r?e.props.loadAnnotations(n.features,e.state.overrideAnnotation):e.props.addLayer(n)).then((function(){if(!r){var t=[];e.props.layers[0].bbox&&e.props.bbox&&(t=[Math.min(e.props.bbox[0],e.props.layers[0].bbox.bounds.minx),Math.min(e.props.bbox[1],e.props.layers[0].bbox.bounds.miny),Math.max(e.props.bbox[2],e.props.layers[0].bbox.bounds.maxx),Math.max(e.props.bbox[3],e.props.layers[0].bbox.bounds.maxy)]),e.state.zoomOnShapefiles&&(e.props.updateBBox(t&&t.length?t:e.props.bbox),e.props.onZoomSelected(t&&t.length?t:e.props.bbox,"EPSG:4326"))}e.props.onSuccess(e.props.layers.length>1?r?"Annotation":e.props.layers[0].name+(0,re.S$)(e.context.messages,"shapefile.success"):void 0),e.props.onLayerAdded(e.props.selected)})).catch((function(t){e.props.onError({type:"error",name:r?"Annotation":e.props.layers[0].name,error:t,message:"shapefile.error.genericLoadError"})}))})),Gt(e,"annotationOptions",(function(){return a().createElement(a().Fragment,null,a().createElement(s.JX,{xs:2},a().createElement("input",{type:"radio",checked:!e.state.overrideAnnotation,onChange:function(){e.setState({overrideAnnotation:!1})}})),a().createElement(s.JX,{style:{paddingLeft:0,paddingTop:1},xs:10},a().createElement("label",null,a().createElement(p.Z,{msgId:"shapefile.merge"}))),a().createElement(s.JX,{xs:2},a().createElement("input",{type:"radio",checked:e.state.overrideAnnotation,onChange:function(){e.setState({overrideAnnotation:!0})}})),a().createElement(s.JX,{style:{paddingLeft:0,paddingTop:1},xs:10},a().createElement("label",null,a().createElement(p.Z,{msgId:"shapefile.replace"}))))})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ft(e,t)}(t,e),r=t,n=[{key:"componentDidMount",value:function(){this.setState({initialLayers:Nt(this.props.layers)})}},{key:"render",value:function(){var e=this,t=zt(this.props.selected);return a().createElement(s.rj,{role:"body",style:{width:"400px"},fluid:!0},this.props.errors?this.renderError():null,this.props.success?this.renderSuccess():null,a().createElement(s.X2,null,a().createElement("h4",null,a().createElement("span",{style:{fontWeight:"bold"}},a().createElement(p.Z,{msgId:"shapefile.layerOf",msgParams:{count:this.findLayerSerialNumber(this.props.selected),total:this.state.initialLayers.length}}))," ",this.props.selected.name)),a().createElement(s.X2,{key:"styler",style:{marginBottom:10}},this.state.useDefaultStyle||t?null:this.props.stylers[this.getGeomType(this.props.selected)]),this.renderDisableStyleCustomization(t),a().createElement(s.X2,{key:"options"},(0,k.Ag)(this.props.selected)?this.annotationOptions():a().createElement(a().Fragment,null,a().createElement(s.JX,{xs:2},a().createElement("input",{"aria-label":"...",type:"checkbox",disabled:t,checked:t||this.state.useDefaultStyle,defaultChecked:t||this.state.useDefaultStyle,onChange:function(t){e.setState({useDefaultStyle:t.target.checked})}})),a().createElement(s.JX,{style:{paddingLeft:0,paddingTop:1},xs:10},a().createElement("label",null,a().createElement(p.Z,{msgId:"shapefile.defaultStyle"}))),a().createElement(s.JX,{xs:2},a().createElement("input",{"aria-label":"...",type:"checkbox",defaultChecked:this.state.zoomOnShapefiles,onChange:function(t){e.setState({zoomOnShapefiles:t.target.checked})}})),a().createElement(s.JX,{style:{paddingLeft:0,paddingTop:1},xs:10},a().createElement("label",null,a().createElement(p.Z,{msgId:"shapefile.zoom"}))))),a().createElement(s.X2,null,a().createElement(s.Si,{style:{display:"flex",justifyContent:"flex-end"}},a().createElement(u.Z,{bsSize:this.props.buttonSize,disabled:!this.props.selected,onClick:function(){e.props.setLayers(null)}},this.props.cancelMessage),a().createElement(u.Z,{bsStyle:"primary",bsSize:this.props.buttonSize,disabled:!this.props.selected,onClick:function(){return e.props.onLayerSkipped(e.props.selected)}},this.props.skipMessage),a().createElement(u.Z,{bsStyle:"primary",bsSize:this.props.buttonSize,disabled:!this.props.selected,onClick:this.addToMap},1===this.props.layers.length?this.props.finishMessage:this.props.nextMessage))))}}],n&&Xt(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(a().Component);Gt(Wt,"propTypes",{bbox:H().array,layers:H().array,selected:H().object,style:H().object,shapeStyle:H().object,onError:H().func,onSuccess:H().func,setLayers:H().func,addLayer:H().func,loadAnnotations:H().func,onSelectLayer:H().func,onLayerAdded:H().func,onLayerSkipped:H().func,onZoomSelected:H().func,updateBBox:H().func,errors:H().array,success:H().string,buttonSize:H().string,cancelMessage:H().object,addMessage:H().object,stylers:H().object,nextMessage:H().object,finishMessage:H().object,skipMessage:H().object}),Gt(Wt,"contextTypes",{messages:H().object}),Gt(Wt,"defaultProps",{buttonSize:"small",setLayers:function(){},addLayer:function(){},loadAnnotations:function(){},updateBBox:function(){},onZoomSelected:function(){},stylers:{},bbox:null});const $t=Wt;var qt=r(61018);function Ht(e){return Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ht(e)}function Yt(){return Yt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yt.apply(null,arguments)}function Kt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nr(n.key),n)}}function Qt(e,t,r){return t=er(t),function(e,t){if(t&&("object"==Ht(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Vt()?Reflect.construct(t,r||[],er(e).constructor):t.apply(e,r))}function Vt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Vt=function(){return!!e})()}function er(e){return er=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},er(e)}function tr(e,t){return tr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},tr(e,t)}function rr(e,t,r){return(t=nr(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nr(e){var t=function(e,t){if("object"!=Ht(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=Ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ht(t)?t:t+""}var or=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Qt(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tr(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e={Polygon:a().createElement(It,null),MultiPolygon:a().createElement(It,null),GeometryCollection:a().createElement(It,null),LineString:a().createElement(_t,null),MultiLineString:a().createElement(_t,null),MultiPoint:a().createElement(Lt,null),Point:a().createElement(Lt,null)},t=a().createElement($t,Yt({},this.props,{setLayers:this.props.setLayers,stylers:e,uploadMessage:a().createElement(Y.Z,{msgId:this.props.uploadMessage}),cancelMessage:a().createElement(Y.Z,{msgId:"shapefile.cancel"}),nextMessage:a().createElement(Y.Z,{msgId:"shapefile.next"}),finishMessage:a().createElement(Y.Z,{msgId:"shapefile.finish"}),skipMessage:a().createElement(Y.Z,{msgId:"shapefile.skip"})}));return this.props.layers?a().createElement(qt.Z,{id:"import-style-dialog",onClose:this.props.onClose,modal:this.props.modal,show:!0,header:a().createElement(Y.Z,{msgId:"shapefile.title"})},t):t}}])&&Kt(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(a().Component);rr(or,"propTypes",{id:H().string,layers:H().array,selected:H().object,style:H().object,shapeStyle:H().object,onError:H().func,setLayers:H().func,addShapeLayer:H().func,onSelectLayer:H().func,onLayerAdded:H().func,error:H().string,mapType:H().string,wrap:H().bool,wrapWithPanel:H().bool,panelStyle:H().object,panelClassName:H().string,visible:H().bool,modal:H().bool,onClose:H().func,closeGlyph:H().string,uploadMessage:H().string,buttonSize:H().string}),rr(or,"defaultProps",{id:"mapstore-shapefile-upload",uploadMessage:"shapefile.placeholder",wrap:!0,modal:!0,wrapWithPanel:!1,panelStyle:{minWidth:"360px",zIndex:1995,position:"absolute",overflow:"visible",top:"30px",left:"calc(50% - 150px)"},panelClassName:"toolbar-panel",visible:!1,onClose:function(){},closeGlyph:"1-close",buttonSize:"small"});const ir=or;var ar=r(881808),lr=r(800827);const cr=(0,n.compose)((0,n.mapPropsStream)((function(e){return e.merge(e.filter((function(e){var t=e.layers;return t&&t.length>0})).exhaustMap((function(){return e.filter((function(e){var t=e.layers;return!t||0===t.length})).take(1).do((function(e){var t=e.onClose,r=void 0===t?function(){}:t;return r&&r()})).ignoreElements()})))})),(0,n.branch)((function(e){return!e.enabled}),n.renderNothing),(0,n.branch)((function(e){var t=e.layers;return!t||0===t.length}),(0,n.compose)((0,$.connect)((0,o.zB)({currentMap:lr.Od}),{loadMap:ar.H0,loadMapInfo:ar.I6}),(0,n.renderComponent)(W))))(ir)},904679:(e,t,r)=>{"use strict";r.d(t,{y:()=>v,p:()=>g});var n=r(717621),o=r.n(n),i=r(423570),a=r.n(i),l=r(903918),c=r.n(l),s=r(441609),u=r.n(s),p=r(166287);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=f(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==f(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var v=function(e){var t=e.marker,r=e.fillColor,n=void 0===r?"#f2f2f2":r,o=e.fillOpacity,i=void 0===o?.3:o,l=e.strokeColor,s=void 0===l?"#3075e9":l,u=e.strokeOpacity,p=void 0===u?1:u,f=e.strokeWidth,y=void 0===f?2:f,m=e.radius,d=void 0===m?10:m,h=e.geometryType,v=void 0===h?"GeometryCollection":h;return{format:"geostyler",metadata:{editorType:"visual"},body:{rules:[].concat(b(t?[{name:"Default Marker Style",ruleId:a()(),symbolizers:[{kind:"Icon",image:c(),opacity:1,size:32,rotate:0,msBringToFront:!0,msHeightReference:"none",symbolizerId:a()()}]}]:[]),b(["GeometryCollection","Point","MultiPoint"].includes(v)&&!t?[{name:"Default Point Style",ruleId:a()(),symbolizers:[{kind:"Mark",color:n,fillOpacity:i,opacity:1,strokeColor:s,strokeOpacity:p,strokeWidth:y,wellKnownName:"Circle",radius:d,msBringToFront:!0,symbolizerId:a()()}]}]:[]),b(["GeometryCollection","LineString","MultiLineString"].includes(v)&&!t?[{name:"Default Line Style",ruleId:a()(),symbolizers:[{kind:"Line",color:s,opacity:p,width:y,symbolizerId:a()()}]}]:[]),b(["GeometryCollection","Polygon","MultiPolygon"].includes(v)&&!t?[{name:"Default Polygon Style",ruleId:a()(),symbolizers:[{kind:"Fill",color:n,fillOpacity:i,outlineColor:s,outlineOpacity:p,outlineWidth:y,symbolizerId:a()()}]}]:[]))}}},g=function(e,t){var r,n,i,a,l,c=(0,p.flattenFeatures)((null==e?void 0:e.features)||[]);if(c.find((function(e){var t;return!u()((null==e?void 0:e.style)||{})&&(null==e||null===(t=e.properties)||void 0===t?void 0:t.id)}))||null!=e&&null!==(r=e.style)&&void 0!==r&&r.format&&!u()(null==e||null===(n=e.style)||void 0===n?void 0:n.body)||(null==e||null===(i=e.style)||void 0===i||!i.format)&&!u()(e.style))return e;var s=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).features,t=((e||[]).find((function(e){var t=e.geometry;return null==t?void 0:t.type}))||{}).geometry;if(!t)return null;var r=t.type.replace("Multi","");return"GeometryCollection"===r||(e||[]).find((function(e){var t,n=e.geometry;return(null==n||null===(t=n.type)||void 0===t?void 0:t.replace("Multi",""))!==r}))?"GeometryCollection":r}({features:c}),f=!(null==t||!t.marker||!["Point","MultiPoint"].includes(s)),y=t&&o()(t.fill).toHexString(),d=null==t||null===(a=t.fill)||void 0===a?void 0:a.a,b=t&&o()(null==t?void 0:t.color).toHexString(),h=null==t||null===(l=t.color)||void 0===l?void 0:l.a,g=null==t?void 0:t.width,S=null==t?void 0:t.radius;return m(m(m({},e),f&&{handleClickOnLayer:!0}),{},{style:v(t?{marker:f,fillColor:y,fillOpacity:d,strokeColor:b,strokeOpacity:h,strokeWidth:g,radius:S,geometryType:s}:{geometryType:s})})}},753325:e=>{e.exports=function(e,t){return e>t}},105076:(e,t,r)=>{var n=r(989881);e.exports=function(e,t){var r;return n(e,(function(e,n,o){return!(r=t(e,n,o))})),!!r}},606162:(e,t,r)=>{var n=r(456029),o=r(753325),i=r(406557);e.exports=function(e){return e&&e.length?n(e,i,o):void 0}},359704:(e,t,r)=>{var n=r(282908),o=r(267206),i=r(105076),a=r(701469),l=r(816612);e.exports=function(e,t,r){var c=a(e)?n:i;return r&&l(e,t,r)&&(t=void 0),c(e,o(t,3))}},218845:(e,t,r)=>{e.exports=r.p+"MapStore2/web/client/components/style/vector/iconNotFound.png"}}]);